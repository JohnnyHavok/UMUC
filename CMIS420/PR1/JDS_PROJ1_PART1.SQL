/* 
**  Author: Justin Smith
**  Course: CMIS 420.7980
**  Date:  04/05/14
**  Project 1 - Part 1
*/


-- Problem 1
CREATE VIEW BUSY_STUDENT
AS SELECT (First_Name || ' ' || Last_Name) AS FULL_NAME, S.Student_ID, E.ENROLL_NUM 
  FROM STUDENT S JOIN 
  (
    SELECT Student_ID, COUNT(Student_ID) AS ENROLL_NUM
      FROM ENROLLMENT
      HAVING COUNT(Student_ID) > 2
      GROUP BY Student_ID
  ) E ON S.Student_ID = E.Student_ID;


-- Problem 2
CREATE TABLE TEMP_STUDENT
( 
  STUD_ID NUMBER(8) NOT NULL,
  FIRST_NAME VARCHAR2(25),
  LAST_NAME VARCHAR2(25),
  ZIP VARCHAR2(5),
  REGISTRATION_DATE DATE NOT NULL,
  CONSTRAINT TEMP_STUDENT_PK PRIMARY KEY (STUD_ID),
  CONSTRAINT ZIP_ZIPCODE_FK FOREIGN KEY (ZIP) REFERENCES ZIPCODE(ZIP),
  CONSTRAINT REGISTRATION_DATE_CHECK CHECK
    (REGISTRATION_DATE > TO_DATE('26-AUG-2005','DD-MON-YYYY'))
);
